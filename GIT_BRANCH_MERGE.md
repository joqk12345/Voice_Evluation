# Git åˆ†æ”¯åˆå¹¶æ“ä½œæ–‡æ¡£

## å°† master åˆ†æ”¯åˆå¹¶åˆ° main åˆ†æ”¯

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜å¦‚ä½•å°† GitHub ä»“åº“çš„ `master` åˆ†æ”¯åˆå¹¶åˆ° `main` åˆ†æ”¯çš„æ“ä½œæ­¥éª¤ã€‚

---

## ğŸ“‹ æ“ä½œæ¦‚è¿°

**ç›®æ ‡**ï¼šå°† `master` åˆ†æ”¯çš„æ‰€æœ‰ä»£ç æ›´æ”¹åˆå¹¶åˆ° `main` åˆ†æ”¯ï¼Œå¹¶æ¨é€åˆ° GitHub è¿œç¨‹ä»“åº“ã€‚

**é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦å°†æ—§çš„ `master` åˆ†æ”¯è¿ç§»åˆ°æ–°çš„ `main` åˆ†æ”¯
- ç»Ÿä¸€ä½¿ç”¨ `main` ä½œä¸ºä¸»åˆ†æ”¯
- åˆå¹¶ä¸¤ä¸ªåˆ†æ”¯çš„å†å²è®°å½•

---

## ğŸ”§ æ“ä½œæ­¥éª¤

### 1. æ£€æŸ¥å½“å‰åˆ†æ”¯çŠ¶æ€

é¦–å…ˆæŸ¥çœ‹å½“å‰çš„åˆ†æ”¯æƒ…å†µï¼š

```bash
# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯ï¼ˆæœ¬åœ°å’Œè¿œç¨‹ï¼‰
git branch -a

# æŸ¥çœ‹å½“å‰çŠ¶æ€
git status
```

**é¢„æœŸè¾“å‡º**ï¼š
- å½“å‰åœ¨ `master` åˆ†æ”¯
- å·¥ä½œç›®å½•å¹²å‡€ï¼ˆæ²¡æœ‰æœªæäº¤çš„æ›´æ”¹ï¼‰

---

### 2. åˆ›å»ºå¹¶åˆ‡æ¢åˆ° main åˆ†æ”¯

ä» `master` åˆ†æ”¯åˆ›å»ºæ–°çš„ `main` åˆ†æ”¯ï¼š

```bash
git checkout -b main
```

**è¯´æ˜**ï¼šè¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ `main` åˆ†æ”¯ï¼Œå¹¶è‡ªåŠ¨åˆ‡æ¢åˆ°è¯¥åˆ†æ”¯ã€‚æ–°åˆ†æ”¯åŒ…å« `master` çš„æ‰€æœ‰å†…å®¹ã€‚

---

### 3. è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯

å¦‚æœè¿œç¨‹ä»“åº“å·²ç»å­˜åœ¨ `main` åˆ†æ”¯ï¼Œéœ€è¦å…ˆè·å–è¿œç¨‹ä¿¡æ¯ï¼š

```bash
git fetch origin
```

**è¯´æ˜**ï¼šè¿™ä¼šæ›´æ–°è¿œç¨‹åˆ†æ”¯çš„å¼•ç”¨ä¿¡æ¯ï¼Œè®©ä½ çœ‹åˆ°è¿œç¨‹çš„ `main` åˆ†æ”¯ã€‚

---

### 4. åˆå¹¶è¿œç¨‹ main åˆ†æ”¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

å¦‚æœè¿œç¨‹å·²ç»å­˜åœ¨ `main` åˆ†æ”¯ï¼Œéœ€è¦å…ˆåˆå¹¶è¿œç¨‹çš„å†…å®¹ï¼š

```bash
git pull origin main --allow-unrelated-histories --no-rebase
```

**å‚æ•°è¯´æ˜**ï¼š
- `--allow-unrelated-histories`ï¼šå…è®¸åˆå¹¶ä¸ç›¸å…³çš„å†å²è®°å½•ï¼ˆå½“ä¸¤ä¸ªåˆ†æ”¯æœ‰ä¸åŒçš„æäº¤å†å²æ—¶å¿…éœ€ï¼‰
- `--no-rebase`ï¼šä½¿ç”¨åˆå¹¶ç­–ç•¥è€Œä¸æ˜¯ rebase

**å¯èƒ½çš„æƒ…å†µ**ï¼š
- å¦‚æœè¿œç¨‹ `main` åˆ†æ”¯å­˜åœ¨ä¸”æœ‰ä¸åŒçš„å†å²ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåˆå¹¶æäº¤
- å¦‚æœè¿œç¨‹ `main` åˆ†æ”¯ä¸å­˜åœ¨ï¼Œå¯ä»¥è·³è¿‡æ­¤æ­¥éª¤

---

### 5. ç¡®ä¿ master çš„æ‰€æœ‰æ›´æ”¹éƒ½åœ¨ main ä¸­

å†æ¬¡åˆå¹¶ `master` åˆ†æ”¯ï¼Œç¡®ä¿æ‰€æœ‰æœ€æ–°æ›´æ”¹éƒ½å·²åŒ…å«ï¼š

```bash
git merge master -m "Merge master branch into main"
```

**è¯´æ˜**ï¼š
- å¦‚æœ `main` å·²ç»åŒ…å« `master` çš„æ‰€æœ‰æ›´æ”¹ï¼Œä¼šæ˜¾ç¤º "Already up to date"
- å¦‚æœæœ‰æ–°çš„æ›´æ”¹ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåˆå¹¶æäº¤

---

### 6. æ¨é€ main åˆ†æ”¯åˆ° GitHub

å°†åˆå¹¶åçš„ `main` åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼š

```bash
# é¦–æ¬¡æ¨é€ï¼Œè®¾ç½®ä¸Šæ¸¸åˆ†æ”¯
git push -u origin main

# æˆ–è€…å¦‚æœå·²ç»è®¾ç½®è¿‡ä¸Šæ¸¸åˆ†æ”¯
git push origin main
```

**è¯´æ˜**ï¼š
- `-u` å‚æ•°ä¼šè®¾ç½® `origin/main` ä½œä¸ºæœ¬åœ° `main` åˆ†æ”¯çš„ä¸Šæ¸¸åˆ†æ”¯
- ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ `git push` æ¨é€

---

### 7. éªŒè¯åˆå¹¶ç»“æœ

æŸ¥çœ‹æäº¤å†å²ï¼Œç¡®è®¤åˆå¹¶æˆåŠŸï¼š

```bash
git log --oneline --graph --all -10
```

**é¢„æœŸç»“æœ**ï¼š
- å¯ä»¥çœ‹åˆ°åˆå¹¶æäº¤
- `main` åˆ†æ”¯åŒ…å« `master` çš„æ‰€æœ‰æäº¤
- ä¸¤ä¸ªåˆ†æ”¯çš„å†å²éƒ½å·²åŒæ­¥

---

## âš™ï¸ å®Œæ•´æ“ä½œæµç¨‹ï¼ˆä¸€é”®æ‰§è¡Œï¼‰

å¦‚æœè¿œç¨‹ä»“åº“å·²ç»å­˜åœ¨ `main` åˆ†æ”¯ï¼Œå®Œæ•´æµç¨‹å¦‚ä¸‹ï¼š

```bash
# 1. ç¡®ä¿åœ¨ master åˆ†æ”¯ä¸”å·¥ä½œç›®å½•å¹²å‡€
git checkout master
git status

# 2. åˆ›å»ºå¹¶åˆ‡æ¢åˆ° main åˆ†æ”¯
git checkout -b main

# 3. è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯
git fetch origin

# 4. åˆå¹¶è¿œç¨‹ main åˆ†æ”¯ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
git pull origin main --allow-unrelated-histories --no-rebase

# 5. åˆå¹¶ master åˆ†æ”¯
git merge master -m "Merge master branch into main"

# 6. æ¨é€ main åˆ†æ”¯
git push -u origin main

# 7. éªŒè¯ç»“æœ
git log --oneline --graph --all -10
```

---

## ğŸš¨ å¸¸è§é—®é¢˜å¤„ç†

### é—®é¢˜ 1ï¼šæ¨é€è¢«æ‹’ç»

**é”™è¯¯ä¿¡æ¯**ï¼š
```
! [rejected]        main -> main (fetch first)
error: failed to push some refs
```

**è§£å†³æ–¹æ³•**ï¼š
```bash
# å…ˆæ‹‰å–è¿œç¨‹ main åˆ†æ”¯
git pull origin main --allow-unrelated-histories --no-rebase

# ç„¶åå†æ¨é€
git push origin main
```

---

### é—®é¢˜ 2ï¼šä¸ç›¸å…³çš„å†å²è®°å½•

**é”™è¯¯ä¿¡æ¯**ï¼š
```
fatal: refusing to merge unrelated histories
```

**è§£å†³æ–¹æ³•**ï¼š
ä½¿ç”¨ `--allow-unrelated-histories` å‚æ•°ï¼š
```bash
git pull origin main --allow-unrelated-histories --no-rebase
```

---

### é—®é¢˜ 3ï¼šåˆå¹¶å†²çª

**è§£å†³æ–¹æ³•**ï¼š
1. æŸ¥çœ‹å†²çªæ–‡ä»¶ï¼š
   ```bash
   git status
   ```

2. æ‰‹åŠ¨è§£å†³å†²çªåï¼š
   ```bash
   git add .
   git commit -m "Resolve merge conflicts"
   ```

3. ç»§ç»­æ¨é€ï¼š
   ```bash
   git push origin main
   ```

---

## ğŸ“ åç»­æ“ä½œå»ºè®®

### 1. è®¾ç½® main ä¸ºé»˜è®¤åˆ†æ”¯

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­ï¼š
1. è®¿é—®ï¼š`https://github.com/ç”¨æˆ·å/ä»“åº“å/settings`
2. æ‰¾åˆ° "Default branch" éƒ¨åˆ†
3. å°†é»˜è®¤åˆ†æ”¯ä» `master` æ”¹ä¸º `main`
4. ç‚¹å‡» "Update" ç¡®è®¤

### 2. æ›´æ–°æœ¬åœ°åˆ†æ”¯è·Ÿè¸ª

å¦‚æœæ›´æ”¹äº†é»˜è®¤åˆ†æ”¯ï¼Œå¯ä»¥æ›´æ–°æœ¬åœ°åˆ†æ”¯ï¼š

```bash
# åˆ‡æ¢åˆ° main åˆ†æ”¯
git checkout main

# æ‹‰å–æœ€æ–°æ›´æ”¹
git pull origin main

# åˆ é™¤æ—§çš„ master åˆ†æ”¯ï¼ˆå¯é€‰ï¼‰
git branch -d master
```

### 3. é€šçŸ¥å›¢é˜Ÿæˆå‘˜

å¦‚æœå›¢é˜Ÿåä½œï¼Œéœ€è¦é€šçŸ¥å…¶ä»–æˆå‘˜ï¼š
- æ–°çš„é»˜è®¤åˆ†æ”¯æ˜¯ `main`
- éœ€è¦æ›´æ–°ä»–ä»¬çš„æœ¬åœ°ä»“åº“é…ç½®
- æ›´æ–° CI/CD é…ç½®ä¸­çš„åˆ†æ”¯åç§°

---

## âœ… æ“ä½œæ£€æŸ¥æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥é¡¹ï¼Œç¡®ä¿æ“ä½œæˆåŠŸï¼š

- [ ] æœ¬åœ° `main` åˆ†æ”¯å·²åˆ›å»º
- [ ] è¿œç¨‹ `main` åˆ†æ”¯å·²åˆå¹¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
- [ ] `master` åˆ†æ”¯çš„æ‰€æœ‰æ›´æ”¹å·²åˆå¹¶åˆ° `main`
- [ ] `main` åˆ†æ”¯å·²æˆåŠŸæ¨é€åˆ° GitHub
- [ ] æäº¤å†å²æ­£ç¡®æ˜¾ç¤ºåˆå¹¶è®°å½•
- [ ] ä»£ç æ–‡ä»¶å®Œæ•´ä¸”æ­£ç¡®

---

## ğŸ“š ç›¸å…³å‘½ä»¤å‚è€ƒ

```bash
# æŸ¥çœ‹åˆ†æ”¯
git branch -a                    # æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
git branch -r                    # æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯
git branch -v                    # æŸ¥çœ‹åˆ†æ”¯è¯¦ç»†ä¿¡æ¯

# åˆ†æ”¯æ“ä½œ
git checkout -b main             # åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯
git checkout main                # åˆ‡æ¢åˆ†æ”¯
git branch -d main               # åˆ é™¤æœ¬åœ°åˆ†æ”¯

# åˆå¹¶æ“ä½œ
git merge master                 # åˆå¹¶ master åˆ°å½“å‰åˆ†æ”¯
git merge --no-ff master         # åˆ›å»ºåˆå¹¶æäº¤ï¼ˆå³ä½¿å¯ä»¥å¿«è¿›ï¼‰

# æ¨é€æ“ä½œ
git push -u origin main          # æ¨é€å¹¶è®¾ç½®ä¸Šæ¸¸åˆ†æ”¯
git push origin main             # æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯

# æŸ¥çœ‹å†å²
git log --oneline --graph --all  # å›¾å½¢åŒ–æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯å†å²
git log main..master             # æŸ¥çœ‹ master ä¸­æœ‰ä½† main ä¸­æ²¡æœ‰çš„æäº¤
```

---

## ğŸ”— ç›¸å…³èµ„æº

- [Git å®˜æ–¹æ–‡æ¡£](https://git-scm.com/doc)
- [GitHub åˆ†æ”¯ç®¡ç†æŒ‡å—](https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository)
- [Git åˆ†æ”¯åˆå¹¶æœ€ä½³å®è·µ](https://git-scm.com/book/en/v2/Git-Branching-Basic-Branching-and-Merging)

---

## ğŸ“… æ–‡æ¡£ä¿¡æ¯

- **åˆ›å»ºæ—¥æœŸ**ï¼š2025-01-27
- **æœ€åæ›´æ–°**ï¼š2025-01-27
- **é€‚ç”¨ç‰ˆæœ¬**ï¼šGit 2.0+

---

**æ³¨æ„**ï¼šåœ¨æ‰§è¡Œä»»ä½• Git æ“ä½œå‰ï¼Œå»ºè®®å…ˆå¤‡ä»½é‡è¦æ•°æ®ï¼Œæˆ–ç¡®ä¿ä»£ç å·²æäº¤åˆ°è¿œç¨‹ä»“åº“ã€‚

